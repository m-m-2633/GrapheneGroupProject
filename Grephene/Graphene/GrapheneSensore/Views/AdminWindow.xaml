<Window x:Class="GrapheneSensore.Views.AdminWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Sensore - Admin Dashboard"
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        
        <Border Grid.Row="0" Background="{StaticResource HeaderGradient}" Padding="24,18">
            <Border.Effect>
                <DropShadowEffect Color="Black" Opacity="0.15" BlurRadius="10" ShadowDepth="2" Direction="270"/>
            </Border.Effect>
            <Grid>
                <StackPanel Orientation="Horizontal">
                    <Border Width="40" Height="40" Background="White" CornerRadius="20" Margin="0,0,15,0">
                        <TextBlock Text="A" FontSize="24" FontWeight="Bold" Foreground="#0066CC" 
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="SENSORE" FontSize="26" FontWeight="Black" Foreground="White" Margin="0,0,0,2"/>
                        <TextBlock Text="Admin Dashboard" FontSize="13" Foreground="White" Opacity="0.9"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <Border Background="#20FFFFFF" CornerRadius="20" Padding="14,8" Margin="0,0,15,0">
                        <StackPanel Orientation="Horizontal">
                            <Border Width="32" Height="32" Background="White" CornerRadius="16" Margin="0,0,10,0">
                                <TextBlock Text="{Binding CurrentUser.FullName, StringFormat={}{0:1}, FallbackValue=A, TargetNullValue=A}" 
                                           FontSize="14" FontWeight="Bold" Foreground="#0066CC" 
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Text="{Binding CurrentUser.FullName, FallbackValue=Admin, TargetNullValue=Admin}" FontSize="15" Foreground="White" 
                                       FontWeight="SemiBold" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Border>
                    <Button Content="Logout" Style="{StaticResource SecondaryButton}" Click="LogoutButton_Click" 
                            Foreground="White" BorderBrush="White" Padding="16,8"/>
                </StackPanel>
            </Grid>
        </Border>

        
        <TabControl Grid.Row="1" Margin="20" BorderThickness="0" Background="Transparent">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" Background="White" Padding="20,10" Margin="0,0,5,0" CornerRadius="8,8,0,0">
                                    <ContentPresenter ContentSource="Header"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="{StaticResource PrimaryBrush}"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            
            <TabItem Header="User Management">
                <Grid Background="White" Margin="0,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    
                    <Border Grid.Row="0" Background="{StaticResource PrimaryLightBrush}" Padding="20" CornerRadius="12,12,0,0">
                        <StackPanel Orientation="Horizontal">
                            <Button Content="âž• Add New User" Style="{StaticResource PrimaryButton}" Click="AddUser_Click" Margin="0,0,10,0"/>
                            <Button Content="ðŸ”„ Refresh" Style="{StaticResource SecondaryButton}" Click="RefreshUsers_Click" Margin="0,0,15,0"/>
                            <Border Background="White" CornerRadius="8" Padding="2">
                                <ComboBox x:Name="UserTypeFilter" Width="150" SelectedIndex="0" 
                                          SelectionChanged="UserTypeFilter_Changed" Style="{StaticResource ModernComboBox}">
                                    <ComboBoxItem Content="All Users"/>
                                    <ComboBoxItem Content="Patients"/>
                                    <ComboBoxItem Content="Clinicians"/>
                                    <ComboBoxItem Content="Admins"/>
                                </ComboBox>
                            </Border>
                        </StackPanel>
                    </Border>

                    
                    <DataGrid Grid.Row="1" 
                              x:Name="UsersDataGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              CanUserDeleteRows="False"
                              SelectionMode="Single"
                              GridLinesVisibility="Horizontal"
                              HeadersVisibility="Column"
                              RowHeight="40"
                              Margin="20"
                              CellEditEnding="UsersDataGrid_CellEditEnding">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Username" Binding="{Binding Username}" Width="150" IsReadOnly="True"/>
                            <DataGridTextColumn Header="First Name" Binding="{Binding FirstName}" Width="120" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Last Name" Binding="{Binding LastName}" Width="120" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200" IsReadOnly="True"/>
                            <DataGridTextColumn Header="User Type" Binding="{Binding UserType}" Width="100" IsReadOnly="True"/>
                            <DataGridTextColumn Header="Phone" Binding="{Binding PhoneNumber}" Width="120" IsReadOnly="True"/>
                            <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive, UpdateSourceTrigger=PropertyChanged}" Width="70" IsReadOnly="False"/>
                            <DataGridTemplateColumn Header="Actions" Width="*">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Button Content="Edit" 
                                                    Click="EditUser_Click" 
                                                    Tag="{Binding UserId}"
                                                    Style="{StaticResource SecondaryButton}"
                                                    Padding="10,5"
                                                    FontSize="12"
                                                    Margin="0,0,5,0"/>
                                            <Button Content="Delete" 
                                                    Click="DeleteUser_Click"
                                                    Tag="{Binding UserId}"
                                                    Style="{StaticResource DangerButton}"
                                                    Padding="10,5"
                                                    FontSize="12"
                                                    Margin="0,0,5,0"/>
                                            <Button Content="Import Data" 
                                                    Click="ImportData_Click"
                                                    Tag="{Binding UserId}"
                                                    Style="{StaticResource PrimaryButton}"
                                                    Padding="10,5"
                                                    FontSize="12"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

            
            <TabItem Header="ðŸ“Š System Statistics">
                <Border Background="White" Padding="30">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Border Grid.Row="0" Background="{StaticResource PrimaryLightBrush}" CornerRadius="12" Padding="20,15" Margin="0,0,0,30">
                        <Grid>
                            <TextBlock Text="ðŸ“ˆ System Overview" FontSize="26" FontWeight="Black" 
                                       Foreground="{StaticResource PrimaryBrush}" VerticalAlignment="Center"/>
                            <Button Content="ðŸ”„ Refresh Statistics" 
                                    Style="{StaticResource PrimaryButton}"
                                    HorizontalAlignment="Right"
                                    Click="RefreshStats_Click"
                                    Padding="16,8"/>
                        </Grid>
                    </Border>

                    
                    <Grid Grid.Row="1" Margin="0,0,0,30">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        
                        <Border Grid.Column="0" Style="{StaticResource ElevatedCard}" 
                                Background="{StaticResource InfoLightBrush}" Margin="0,0,10,0">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="ðŸ‘¥" FontSize="20" Margin="0,0,8,0"/>
                                    <TextBlock Text="Total Patients" FontSize="14" FontWeight="SemiBold" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="TotalPatientsText" Text="0" FontSize="40" FontWeight="Black" 
                                           Foreground="{StaticResource InfoBrush}"/>
                                <Border Height="3" Background="{StaticResource InfoBrush}" CornerRadius="2" 
                                        Margin="0,10,0,0" HorizontalAlignment="Left" Width="60"/>
                            </StackPanel>
                        </Border>

                        
                        <Border Grid.Column="1" Style="{StaticResource ElevatedCard}" 
                                Background="{StaticResource SuccessLightBrush}" Margin="0,0,10,0">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="ðŸ©º" FontSize="20" Margin="0,0,8,0"/>
                                    <TextBlock Text="Total Clinicians" FontSize="14" FontWeight="SemiBold" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="TotalCliniciansText" Text="0" FontSize="40" FontWeight="Black" 
                                           Foreground="{StaticResource SuccessBrush}"/>
                                <Border Height="3" Background="{StaticResource SuccessBrush}" CornerRadius="2" 
                                        Margin="0,10,0,0" HorizontalAlignment="Left" Width="60"/>
                            </StackPanel>
                        </Border>

                        
                        <Border Grid.Column="2" Style="{StaticResource ElevatedCard}" 
                                Background="{StaticResource ErrorLightBrush}" Margin="0,0,10,0">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="âš " FontSize="20" Margin="0,0,8,0"/>
                                    <TextBlock Text="Active Alerts" FontSize="14" FontWeight="SemiBold" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="ActiveAlertsText" Text="0" FontSize="40" FontWeight="Black" 
                                           Foreground="{StaticResource ErrorBrush}"/>
                                <Border Height="3" Background="{StaticResource ErrorBrush}" CornerRadius="2" 
                                        Margin="0,10,0,0" HorizontalAlignment="Left" Width="60"/>
                            </StackPanel>
                        </Border>

                        
                        <Border Grid.Column="3" Style="{StaticResource ElevatedCard}" 
                                Background="{StaticResource WarningLightBrush}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <TextBlock Text="ðŸ“Š" FontSize="20" Margin="0,0,8,0"/>
                                    <TextBlock Text="Total Data Points" FontSize="14" FontWeight="SemiBold" 
                                               Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="TotalDataPointsText" Text="0" FontSize="40" FontWeight="Black" 
                                           Foreground="{StaticResource WarningBrush}"/>
                                <Border Height="3" Background="{StaticResource WarningBrush}" CornerRadius="2" 
                                        Margin="0,10,0,0" HorizontalAlignment="Left" Width="60"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    
                    <Border Grid.Row="2" Style="{StaticResource ElevatedCard}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="{StaticResource ErrorLightBrush}" CornerRadius="8" Padding="12,10" Margin="0,0,0,15">
                                <Grid>
                                    <TextBlock Text="ðŸ”” Alerts" FontSize="18" FontWeight="Bold" 
                                               Foreground="{StaticResource ErrorBrush}" VerticalAlignment="Center"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <RadioButton x:Name="RecentAlertsRadio" 
                                                     Content="Recent (100)" 
                                                     Style="{StaticResource ModernRadioButton}"
                                                     IsChecked="True"
                                                     Checked="AlertFilter_Changed"
                                                     Margin="0,0,10,0"/>
                                        <RadioButton x:Name="AllAlertsRadio" 
                                                     Content="All" 
                                                     Style="{StaticResource ModernRadioButton}"
                                                     Checked="AlertFilter_Changed"/>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <DataGrid Grid.Row="1"
                                      x:Name="AlertsDataGrid"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      IsReadOnly="True"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column"
                                      RowHeight="35">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Patient" Binding="{Binding User.FullName}" Width="150"/>
                                    <DataGridTextColumn Header="Alert Type" Binding="{Binding AlertType}" Width="120"/>
                                    <DataGridTextColumn Header="Severity" Binding="{Binding Severity}" Width="100"/>
                                    <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*"/>
                                    <DataGridTextColumn Header="Date/Time" Binding="{Binding AlertDateTime, StringFormat='{}{0:MMM dd, yyyy HH:mm}'}" Width="150"/>
                                    <DataGridCheckBoxColumn Header="Ack" Binding="{Binding IsAcknowledged}" Width="50"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>
                </Grid>
                </Border>
            </TabItem>

            
            <TabItem Header="ðŸ“‹ Feedback System">
                <Border Background="White" Padding="30">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        
                        <StackPanel Grid.Row="0" Margin="0,0,0,30">
                            <TextBlock Text="ðŸŽ¯ Applicant Feedback Management System" 
                                       FontSize="24" 
                                       FontWeight="Bold" 
                                       Foreground="#1976D2"
                                       Margin="0,0,0,10"/>
                            <TextBlock Text="Manage applicants, create feedback using templates, and generate professional PDF reports." 
                                       FontSize="14" 
                                       Foreground="#757575"
                                       TextWrapping="Wrap"/>
                        </StackPanel>

                        
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <UniformGrid Columns="2" Rows="2">
                                
                                <Border Background="#F5F5F5" 
                                        CornerRadius="12" 
                                        Padding="25"
                                        Margin="5">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.2"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="ðŸ‘¥" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                                        <TextBlock Text="Applicant Management" 
                                                   FontSize="18" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,10"/>
                                        <TextBlock Text="Add, edit, and organize applicants for feedback evaluation. Track applicant information and manage your evaluation list."
                                                   FontSize="13"
                                                   Foreground="#757575"
                                                   TextWrapping="Wrap"
                                                   TextAlignment="Center"
                                                   Margin="0,0,0,20"/>
                                        <Button Content="ðŸš€ Open Applicant Manager"
                                                Style="{StaticResource PrimaryButton}"
                                                Click="OpenFeedbackSystem_Click"
                                                HorizontalAlignment="Center"
                                                Padding="20,12"/>
                                    </StackPanel>
                                </Border>

                                
                                <Border Background="#F5F5F5" 
                                        CornerRadius="12" 
                                        Padding="25"
                                        Margin="5">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.2"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                                        <TextBlock Text="Template Builder" 
                                                   FontSize="18" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,10"/>
                                        <TextBlock Text="Create custom feedback templates with sections and codes. Link sections to templates and manage evaluation criteria."
                                                   FontSize="13"
                                                   Foreground="#757575"
                                                   TextWrapping="Wrap"
                                                   TextAlignment="Center"
                                                   Margin="0,0,0,20"/>
                                        <Button Content="ðŸ”§ Coming Soon"
                                                Style="{StaticResource SecondaryButton}"
                                                IsEnabled="False"
                                                HorizontalAlignment="Center"
                                                Padding="20,12"/>
                                    </StackPanel>
                                </Border>

                                
                                <Border Background="#F5F5F5" 
                                        CornerRadius="12" 
                                        Padding="25"
                                        Margin="5">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.2"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“š" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                                        <TextBlock Text="Paragraph Library" 
                                                   FontSize="18" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,10"/>
                                        <TextBlock Text="Store reusable feedback paragraphs to avoid repetitive typing. Organize by category and quickly insert into feedback."
                                                   FontSize="13"
                                                   Foreground="#757575"
                                                   TextWrapping="Wrap"
                                                   TextAlignment="Center"
                                                   Margin="0,0,0,20"/>
                                        <Button Content="ðŸ”§ Coming Soon"
                                                Style="{StaticResource SecondaryButton}"
                                                IsEnabled="False"
                                                HorizontalAlignment="Center"
                                                Padding="20,12"/>
                                    </StackPanel>
                                </Border>

                                
                                <Border Background="#F5F5F5" 
                                        CornerRadius="12" 
                                        Padding="25"
                                        Margin="5">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="8" ShadowDepth="2" Opacity="0.2"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“Š" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,15"/>
                                        <TextBlock Text="Reports &amp; PDF Export" 
                                                   FontSize="18" 
                                                   FontWeight="Bold" 
                                                   HorizontalAlignment="Center"
                                                   Margin="0,0,0,10"/>
                                        <TextBlock Text="Generate professional PDF feedback reports. Send bulk emails with attachments to multiple applicants."
                                                   FontSize="13"
                                                   Foreground="#757575"
                                                   TextWrapping="Wrap"
                                                   TextAlignment="Center"
                                                   Margin="0,0,0,20"/>
                                        <Button Content="ðŸ”§ Coming Soon"
                                                Style="{StaticResource SecondaryButton}"
                                                IsEnabled="False"
                                                HorizontalAlignment="Center"
                                                Padding="20,12"/>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
